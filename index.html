<style>
    #tap {
        width: 100%;
        height: 100%;
        background-color: rgb(255, 255, 255);
        margin: none;
        padding: none;
        touch-action: none;
        user-select: none;
        position: absolute;
    }
    body {
        overflow: hidden;
    }
</style>
<h1>
    <h1 id="coords">Tap anywhere</h1>
    <canvas id="tap"></canvas>
    <!-- <button type="button" id="btn" onclick="send()">Send</button> -->
</h1>

<script>
    const canvas = document.getElementById("tap");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth * 0.9;
    canvas.height = window.innerHeight * 0.7;
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;

    let points = [];
    let clicked = false;

    let lastX = 0;
    let lastY = 0;
    let x,
        y = 0;
    canvas.addEventListener("mousedown", (e) => {
        lastX = x;
        lastY = y;
        clicked = true;
    });
    canvas.addEventListener("mouseup", (e) => {
        e.preventDefault();
        clicked = false;
    });
    canvas.addEventListener("touchstart", (e) => {
        lastX = x;
        lastY = y;

        clicked = true;
    });
    canvas.addEventListener("touchend", (e) => {
        e.preventDefault();
        clicked = false;
    });
    canvas.addEventListener("touchmove", (e) => {
        draw(e);
    });

    canvas.addEventListener("mousemove", (e) => {
        draw(e);
    });
    function draw(e) {
        if (!clicked) return;
        e.preventDefault();
        const rect = canvas.getBoundingClientRect();
        let x, y;
        if (e.touches && e.touches[0]) {
            x = e.touches[0].clientX - rect.left;
            y = e.touches[0].clientY - rect.top;
        } else {
            x = e.clientX - rect.left;
            y = e.clientY - rect.top;
        }

        ctx.strokeStyle = "black";
        ctx.lineWidth = 12;
        ctx.lineCap = "round";

        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.stroke();

        lastX = x;
        lastY = y;

        points.push([x, y]);
    }

    setInterval(() => {
        if (points.length > 0) {
            fetch("/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    Connection: "close",
                },

                body: JSON.stringify(points),
            });
            points = [];
        }
    }, 1000);
    // }
</script>
